FROM golangci/golangci-lint:v2.0 as cache
ENV GOLANGCI_LINT_CACHE /root/.cache/go-build
WORKDIR $GOPATH/src/github.com/kanopy-platform/grafana-auth-proxy

# download modules and build cache
COPY go.mod go.sum ./
RUN go mod download

COPY . .

RUN make test
